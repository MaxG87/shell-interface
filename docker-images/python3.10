# python:3.10.12-slim-bookworm as of 15 June 2023
FROM python@sha256:c11490fd02e0cda47e577d2aca36fa6509c71308a675d18a2e881864f8798736

# Provide excecutables
ENV DEBIAN_FRONTEND=noninteractive
RUN apt update && \
    apt install -y make python3 python3-poetry && \
    apt autoclean

# Setup production dependencies
WORKDIR /project
COPY pyproject.toml poetry.lock ./
RUN poetry install

# Install project
COPY src/ src/
RUN poetry install

CMD poetry run pytest --no-cov .
